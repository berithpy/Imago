#!/usr/bin/env node
// Generates a fresh .dev.vars file with random secrets for local development.
// Run with: npm run setup:dev

import { randomBytes } from "crypto";
import { writeFileSync, existsSync } from "fs";
import { resolve } from "path";

const target = resolve(process.cwd(), ".dev.vars");

if (existsSync(target)) {
  const args = process.argv.slice(2);
  if (!args.includes("--force")) {
    console.log(".dev.vars already exists. Pass --force to overwrite.");
    process.exit(0);
  }
}

function secret(bytes = 32) {
  return randomBytes(bytes).toString("hex");
}

const contents = `# Local development secrets â€” NEVER commit this file
# Generated by scripts/generate-dev-vars.js

JWT_SECRET=${secret()}
BETTER_AUTH_SECRET=${secret()}
ADMIN_RESET_SECRET=${secret(16)}
RESEND_API_KEY=re_placeholder
`;

writeFileSync(target, contents, "utf8");
console.log(".dev.vars created with fresh random secrets.");
console.log("Remember to set RESEND_API_KEY if you need email functionality.");
